(()=>{var e={};e.id=636,e.ids=[636],e.modules={361:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},979:()=>{},2015:e=>{"use strict";e.exports=require("react")},2326:e=>{"use strict";e.exports=require("react-dom")},2474:()=>{},4075:e=>{"use strict";e.exports=require("zlib")},4337:e=>{"use strict";e.exports=import("firebase/firestore")},5492:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{As:()=>l,OJ:()=>c});var a=r(8732),i=r(2015),o=r(9582),n=r(6958),u=e([o,n]);[o,n]=u.then?(await u)():u;let d=(0,i.createContext)({});function l(){return(0,i.useContext)(d)}function c({children:e}){let[t,r]=(0,i.useState)(null),[s,u]=(0,i.useState)(!0),l=async()=>{console.log("[AuthContext] Logging out..."),await fetch("/api/sessionLogout",{method:"POST"}),await (0,n.signOut)(o.j2),console.log("[AuthContext] Signed out from Firebase Auth")};return(0,a.jsx)(d.Provider,{value:{currentUser:t,loading:s,logout:l},children:e})}s()}catch(e){s(e)}})},6047:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>c});var a=r(8732);r(979);var i=r(5492),o=r(4233),n=r(2015);r(2474);var u=e([i]);function l(){let{currentUser:e,logout:t}=(0,i.As)(),r=(0,o.useRouter)(),[s,u]=(0,n.useState)(!1);console.log("[Navbar] currentUser:",e);let l=["/login","/signup"].includes(r.pathname);if(!s||l)return null;let c=async()=>{await t(),r.push("/login")};return(0,a.jsxs)("nav",{className:"w-full bg-white border-b border-gray-200 px-2 py-2 md:px-8 flex flex-col md:flex-row items-center justify-between sticky top-0 z-50",children:[(0,a.jsx)("div",{className:"font-bold text-indigo-700 text-xl cursor-pointer mb-2 md:mb-0",onClick:()=>r.push("/"),children:"FleetFras"}),e&&(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-2 md:gap-4 w-full md:w-auto",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-1 bg-gray-100 rounded-md px-3 py-1 border border-gray-200 text-gray-900 text-sm font-medium w-full md:w-auto",children:[(0,a.jsx)("span",{className:"font-semibold",children:e.displayName||"No Name"}),(0,a.jsx)("span",{className:"text-indigo-600 text-xs md:ml-2 break-all",children:e.email})]}),(0,a.jsx)("button",{className:"w-full md:w-auto px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md font-medium text-sm",onClick:()=>r.push("/"),children:"Home"}),(0,a.jsx)("button",{className:"w-full md:w-auto px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md font-medium text-sm",onClick:c,children:"Logout"})]})]})}function c({Component:e,pageProps:t}){return(0,a.jsxs)(i.OJ,{children:[(0,a.jsx)(l,{}),(0,a.jsx)(e,{...t})]})}i=(u.then?(await u)():u)[0],s()}catch(e){s(e)}})},6551:e=>{"use strict";e.exports=import("firebase/app")},6958:e=>{"use strict";e.exports=import("firebase/auth")},7910:e=>{"use strict";e.exports=require("stream")},8732:e=>{"use strict";e.exports=require("react/jsx-runtime")},9021:e=>{"use strict";e.exports=require("fs")},9582:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{G6:()=>m,db:()=>c,j2:()=>l});var a=r(6551),i=r(6958),o=r(4337),n=e([a,i,o]);[a,i,o]=n.then?(await n)():n;let u=(0,a.initializeApp)({apiKey:"AIzaSyDsXS1vhUGDVZVaFR_XKpdhzQAzLTyV6kg",authDomain:"car-management-system-d6ff2.firebaseapp.com",projectId:"car-management-system-d6ff2",storageBucket:"car-management-system-d6ff2.firebasestorage.app",messagingSenderId:"07165218280",appId:"1:707165218280:web:7e719544c58d5b49f1f05d"}),l=(0,i.getAuth)(u),c=(0,o.getFirestore)(u),d=new i.GoogleAuthProvider,m=async()=>{try{let e=await (0,i.signInWithPopup)(l,d);i.GoogleAuthProvider.credentialFromResult(e).accessToken;let t=e.user;return(await (0,o.getDoc)((0,o.doc)(c,"users",t.uid))).exists()||await (0,o.setDoc)((0,o.doc)(c,"users",t.uid),{email:t.email,name:t.displayName,role:"purchaser",createdAt:new Date().toISOString()}),t}catch(e){throw console.error("Error signing in with Google:",e),e}};s()}catch(e){s(e)}})}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[89,233],()=>r(6047));module.exports=s})();