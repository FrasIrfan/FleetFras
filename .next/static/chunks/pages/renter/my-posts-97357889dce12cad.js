(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[895],{4447:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var i=r(7876),d=r(1898),s=r(9099),o=r(4232),n=r(4234),a=r(2009);function l(){let{currentUser:e,logout:t}=(0,d.As)();(0,s.useRouter)();let[r,l]=(0,o.useState)([]),[c,f]=(0,o.useState)(!0),[u,p]=(0,o.useState)(null),[h,m]=(0,o.useState)([]),[x,g]=(0,o.useState)(null),[b,y]=(0,o.useState)([]),[j,v]=(0,o.useState)("");(0,o.useEffect)(()=>{(async()=>{if(!e)return;f(!0);let t=(0,a.P)((0,a.rJ)(n.db,"posts"),(0,a._M)("ownerId","==",e.uid));l((await (0,a.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))),f(!1)})()},[e]),(0,o.useEffect)(()=>{u&&(async()=>{m((await (0,a.GG)((0,a.P)((0,a.rJ)(n.db,"chats"),(0,a._M)("postId","==",u)))).docs.map(e=>({id:e.id,...e.data()}))),g(null),y([])})()},[u]),(0,o.useEffect)(()=>{if(!x)return;let e=(0,a.aQ)((0,a.H9)(n.db,"chats",x.id),e=>{var t;y((null==(t=e.data())?void 0:t.messages)||[])});return()=>e()},[x]);let w=async()=>{if(!j.trim()||!x)return;let t={sender:e.uid,text:j,timestamp:Date.now()},r=(0,a.H9)(n.db,"chats",x.id);await (0,a.mZ)(r,{messages:[...b,t]}),v("")};return(0,i.jsx)("div",{style:{padding:"2rem",minHeight:"100vh",background:"#f3f4f6"},children:(0,i.jsxs)("div",{style:{maxWidth:900,margin:"2rem auto"},children:[(0,i.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"1rem",marginBottom:"1.5rem"}}),(0,i.jsxs)("div",{style:{background:"#fff",borderRadius:12,boxShadow:"0 2px 12px rgba(0,0,0,0.10)",padding:"2rem",color:"#222"},children:[(0,i.jsx)("h1",{style:{marginBottom:"1.5rem",color:"#222"},children:"My Posts"}),c?(0,i.jsx)("p",{children:"Loading posts..."}):0===r.length?(0,i.jsx)("p",{children:"No posts found."}):(0,i.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"1.5rem",marginTop:"1rem"},children:r.map(t=>(0,i.jsxs)("div",{style:{flex:"1 1 280px",minWidth:280,maxWidth:340,background:"#f9fafb",borderRadius:10,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",padding:"1.5rem",border:"1px solid #e5e7eb",display:"flex",flexDirection:"column",justifyContent:"space-between",position:"relative"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{fontWeight:700,color:"#4f46e5",fontSize:"1.1rem",marginBottom:6},children:["$",t.price]}),(0,i.jsx)("h2",{style:{fontSize:"1.2rem",fontWeight:600,color:"#222",marginBottom:8},children:t.title}),(0,i.jsx)("p",{style:{color:"#444",marginBottom:12},children:t.description}),(0,i.jsxs)("div",{style:{color:"#4f46e5",fontSize:13,marginBottom:6},children:["Owner: ",(null==e?void 0:e.displayName)||"No Name"," (",(0,i.jsx)("span",{style:{color:"#6366f1"},children:(null==e?void 0:e.email)||""}),")"]})]}),(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",marginTop:10},children:(0,i.jsx)("span",{style:{padding:"0.3rem 0.9rem",borderRadius:20,fontWeight:600,fontSize:"0.95rem",background:"approved"===t.status?"#e0fbe3":"rejected"===t.status?"#fee2e2":"#fef9c3",color:"approved"===t.status?"#16a34a":"rejected"===t.status?"#dc2626":"#b45309",border:"1px solid",borderColor:"approved"===t.status?"#bbf7d0":"rejected"===t.status?"#fecaca":"#fde68a"},children:t.status})}),(0,i.jsx)("button",{style:{marginTop:12,background:"#4f46e5",color:"#fff",border:"none",borderRadius:6,padding:"0.5rem 1rem",fontWeight:500,cursor:"pointer"},onClick:()=>p(t.id),children:"View Chats"}),u===t.id&&(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.25)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsxs)("div",{style:{background:"#fff",borderRadius:12,boxShadow:"0 2px 16px rgba(0,0,0,0.18)",padding:"2rem",minWidth:400,maxWidth:600,width:"100%",maxHeight:600,overflow:"auto",position:"relative"},children:[(0,i.jsx)("button",{style:{position:"absolute",top:12,right:12,background:"#eee",border:"none",borderRadius:6,padding:"0.3rem 0.8rem",cursor:"pointer",fontWeight:600},onClick:()=>p(null),children:"X"}),(0,i.jsxs)("h3",{style:{color:"#4f46e5",marginBottom:12},children:["Chats for: ",t.title]}),0===h.length?(0,i.jsx)("p",{style:{color:"#888"},children:"No chats for this post yet."}):(0,i.jsxs)("div",{style:{display:"flex",gap:16},children:[(0,i.jsx)("div",{style:{minWidth:120},children:h.map(e=>(0,i.jsxs)("div",{style:{marginBottom:10,cursor:"pointer",background:(null==x?void 0:x.id)===e.id?"#e0e7ff":"#f9fafb",borderRadius:8,padding:8,border:"1px solid #eee"},onClick:()=>g(e),children:["Purchaser: ",e.userId]},e.id))}),(0,i.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:x?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{flex:1,overflowY:"auto",marginBottom:12,background:"#f9fafb",borderRadius:8,padding:10,border:"1px solid #eee",minHeight:200,maxHeight:250},children:0===b.length?(0,i.jsx)("p",{style:{color:"#888"},children:"No messages yet."}):b.map((t,r)=>(0,i.jsxs)("div",{style:{marginBottom:10,textAlign:t.sender===e.uid?"right":"left"},children:[(0,i.jsx)("div",{style:{fontSize:12,color:"#888",marginBottom:2,textAlign:t.sender===e.uid?"right":"left"},children:t.sender===e.uid?"You:":"Purchaser:"}),(0,i.jsx)("span",{style:{display:"inline-block",background:t.sender===e.uid?"#4f46e5":"#e0e7ff",color:t.sender===e.uid?"#fff":"#222",borderRadius:16,padding:"0.5rem 1rem",fontWeight:500,maxWidth:"70%",wordBreak:"break-word"},children:t.text})]},r))}),(0,i.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,i.jsx)("input",{type:"text",value:j,onChange:e=>v(e.target.value),placeholder:"Type your message...",style:{flex:1,padding:"0.75rem",borderRadius:8,border:"1px solid #bbb",fontSize:"1rem"},onKeyDown:e=>{"Enter"===e.key&&w()}}),(0,i.jsx)("button",{onClick:w,style:{padding:"0.75rem 1.5rem",background:"#4f46e5",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:"pointer"},children:"Send"})]})]}):(0,i.jsx)("div",{style:{color:"#888",marginTop:40,textAlign:"center"},children:"Select a chat to view messages."})})]})]})})]},t.id))})]})]})})}},5470:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/renter/my-posts",function(){return r(4447)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(5470)),_N_E=e.O()}]);