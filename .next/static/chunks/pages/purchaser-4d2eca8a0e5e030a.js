(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[745],{7459:(e,r,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/purchaser",function(){return t(8744)}])},8744:(e,r,t)=>{"use strict";t.r(r),t.d(r,{__N_SSP:()=>u,default:()=>l});var o=t(7876),s=t(1898),n=t(9099),i=t(4232),d=t(4234),a=t(2009),u=!0;function l(){let{currentUser:e,logout:r}=(0,s.As)(),t=(0,n.useRouter)(),[u,l]=(0,i.useState)(null),[c,h]=(0,i.useState)(!0),[p,f]=(0,i.useState)("purchaser");(0,i.useEffect)(()=>{(async()=>{if(!e)return;h(!0);let r=(0,a.P)((0,a.rJ)(d.db,"roleRequests"),(0,a._M)("userId","==",e.uid)),t=await (0,a.GG)(r);t.empty?l(null):l(t.docs[0].data().status);let o=await (0,a.GG)((0,a.P)((0,a.rJ)(d.db,"users"),(0,a._M)("email","==",e.email)));o.empty||f(o.docs[0].data().role),h(!1)})()},[e]);let m=async()=>{if(e)try{await (0,a.gS)((0,a.rJ)(d.db,"roleRequests"),{userId:e.uid,email:e.email,status:"pending",createdAt:new Date().toISOString()}),l("pending")}catch(e){alert("Failed to submit request")}},g=async()=>{e&&(await (0,a.mZ)((0,a.H9)(d.db,"users",e.uid),{role:"renter"}),t.push("/renter"))};return(0,o.jsxs)("div",{style:{padding:"2rem",minHeight:"100vh",background:"#f3f4f6"},children:[(0,o.jsx)("div",{style:{maxWidth:600,margin:"2rem auto"},children:(0,o.jsxs)("div",{style:{background:"#fff",borderRadius:12,boxShadow:"0 2px 12px rgba(0,0,0,0.10)",padding:"2rem",color:"#222"},children:[(0,o.jsx)("h1",{style:{marginBottom:"0.5rem",color:"#222"},children:"Welcome to the Purchaser Dashboard!"}),(0,o.jsxs)("p",{style:{marginBottom:"2rem",color:"#444"},children:["Your role: ",(0,o.jsx)("strong",{children:"purchaser"})]}),(0,o.jsx)("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem"},children:(0,o.jsx)("button",{style:{padding:"0.75rem 1.5rem",fontSize:"1rem",background:"#4f46e5",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontWeight:500},onClick:()=>t.push("/purchaser/posts"),children:"\uD83D\uDD0D View Available Posts"})}),"purchaser"===p&&(0,o.jsx)("button",{style:{marginTop:16,padding:"0.5rem 1.2rem",background:"#6366f1",color:"#fff",border:"none",borderRadius:6,fontWeight:500,cursor:"pointer"},onClick:g,children:"Switch to Renter"}),(0,o.jsx)("div",{style:{marginTop:"2rem"},children:c?(0,o.jsx)("p",{children:"Loading role switch status..."}):"pending"===u?(0,o.jsxs)("p",{children:["Your request to become a renter is ",(0,o.jsx)("strong",{children:"pending approval"}),"."]}):"approved"===u?(0,o.jsxs)("p",{children:["Your request to become a renter has been ",(0,o.jsx)("strong",{children:"approved"}),"."]}):"rejected"===u?(0,o.jsxs)("p",{children:["Your request to become a renter was ",(0,o.jsx)("strong",{children:"rejected"}),"."]}):(0,o.jsx)("button",{onClick:m,style:{padding:"0.5rem 1rem",fontSize:"1rem",background:"#6366f1",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontWeight:500},children:"Request to become a Renter"})})]})}),(0,o.jsx)("div",{style:{position:"fixed",bottom:32,right:32,zIndex:1e3},children:(0,o.jsx)("button",{style:{background:"#4f46e5",color:"#fff",border:"none",borderRadius:"50%",width:60,height:60,fontSize:28,boxShadow:"0 4px 16px rgba(79,70,229,0.15)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700},onClick:()=>t.push("/purchaser/chats"),title:"Support Chat",children:"\uD83D\uDCAC"})})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[636,593,792],()=>r(7459)),_N_E=e.O()}]);