(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[309],{4563:(e,r,o)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return o(7596)}])},7596:(e,r,o)=>{"use strict";o.r(r),o.d(r,{__N_SSP:()=>l,default:()=>c});var t=o(7876),d=o(1898),s=o(4232),i=o(4234),n=o(2009),a=o(9099),l=!0;function c(){let{currentUser:e,logout:r}=(0,d.As)(),o=(0,a.useRouter)(),[l,c]=(0,s.useState)([]),[h,u]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{u(!0);let e=(await (0,n.GG)((0,n.rJ)(i.db,"roleRequests"))).docs.map(e=>({id:e.id,...e.data()}));c(e),u(!1),console.log("[AdminDashboard] Fetched role requests:",e)})()},[]);let p=async e=>{try{await (0,n.mZ)((0,n.H9)(i.db,"users",e.userId),{role:"renter"}),await (0,n.mZ)((0,n.H9)(i.db,"roleRequests",e.id),{status:"approved"}),c(r=>r.map(r=>r.id===e.id?{...r,status:"approved"}:r)),console.log("[AdminDashboard] Approved request:",e)}catch(e){alert("Failed to approve request"),console.error("[AdminDashboard] Error approving request:",e)}},m=async e=>{try{await (0,n.mZ)((0,n.H9)(i.db,"roleRequests",e.id),{status:"rejected"}),c(r=>r.map(r=>r.id===e.id?{...r,status:"rejected"}:r)),console.log("[AdminDashboard] Rejected request:",e)}catch(e){alert("Failed to reject request"),console.error("[AdminDashboard] Error rejecting request:",e)}};return console.log("[AdminDashboard] currentUser:",e),(0,t.jsxs)("div",{style:{padding:"2rem",minHeight:"100vh",background:"#f3f4f6",position:"relative"},children:[(0,t.jsx)("div",{style:{maxWidth:800,margin:"2rem auto"},children:(0,t.jsxs)("div",{style:{background:"#fff",borderRadius:12,boxShadow:"0 2px 12px rgba(0,0,0,0.10)",padding:"2rem",color:"#222"},children:[(0,t.jsx)("h1",{style:{marginBottom:"0.5rem",color:"#222"},children:"Welcome to the Admin Dashboard!"}),(0,t.jsxs)("p",{style:{marginBottom:"2rem",color:"#444"},children:["Your role: ",(0,t.jsx)("strong",{children:"admin"})]}),(0,t.jsx)("div",{style:{marginBottom:"2rem"},children:(0,t.jsx)("button",{style:{padding:"0.75rem 1.5rem",fontSize:"1rem",background:"#4f46e5",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontWeight:500},onClick:()=>o.push("/admin/posts"),children:"\uD83D\uDCDD Manage Posts"})}),(0,t.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,t.jsx)("h2",{style:{marginBottom:"1rem",color:"#222"},children:"Role Switch Requests"}),(0,t.jsx)("div",{style:{background:"#f9fafb",borderRadius:10,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",padding:"1.5rem",border:"1px solid #e5e7eb",marginTop:8},children:h?(0,t.jsx)("p",{children:"Loading requests..."}):0===l.length?(0,t.jsx)("p",{children:"No role switch requests found."}):(0,t.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"0.5rem"},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{style:{background:"#f3f4f6"},children:[(0,t.jsx)("th",{style:{border:"1px solid #d1d5db",padding:"0.75rem",color:"#222",fontWeight:600},children:"Email"}),(0,t.jsx)("th",{style:{border:"1px solid #d1d5db",padding:"0.75rem",color:"#222",fontWeight:600},children:"Status"}),(0,t.jsx)("th",{style:{border:"1px solid #d1d5db",padding:"0.75rem",color:"#222",fontWeight:600},children:"Actions"})]})}),(0,t.jsx)("tbody",{children:l.map((e,r)=>(0,t.jsxs)("tr",{style:{background:r%2==0?"#fff":"#f3f4f6",transition:"background 0.2s"},children:[(0,t.jsx)("td",{style:{border:"1px solid #e5e7eb",padding:"0.75rem",color:"#444"},children:e.email}),(0,t.jsx)("td",{style:{border:"1px solid #e5e7eb",padding:"0.75rem",color:"approved"===e.status?"#16a34a":"rejected"===e.status?"#dc2626":"#b45309",fontWeight:600,textTransform:"capitalize"},children:e.status}),(0,t.jsx)("td",{style:{border:"1px solid #e5e7eb",padding:"0.75rem"},children:"pending"===e.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>p(e),style:{marginRight:"0.5rem",background:"#4f46e5",color:"#fff",border:"none",borderRadius:6,padding:"0.5rem 1rem",cursor:"pointer",fontWeight:500},children:"Approve"}),(0,t.jsx)("button",{onClick:()=>m(e),style:{background:"#dc2626",color:"#fff",border:"none",borderRadius:6,padding:"0.5rem 1rem",cursor:"pointer",fontWeight:500},children:"Reject"})]})})]},e.id))})]})})]})]})}),(0,t.jsx)("div",{style:{position:"fixed",bottom:32,right:32,zIndex:1e3},children:(0,t.jsx)("button",{style:{background:"#4f46e5",color:"#fff",border:"none",borderRadius:"50%",width:60,height:60,fontSize:28,boxShadow:"0 4px 16px rgba(79,70,229,0.15)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700},onClick:()=>{console.log("[AdminDashboard] Floating chat button clicked"),o.push("/admin/chats").catch(e=>{console.error("Router push error:",e),window.location.href="/admin/chats"})},title:"Admin Chats",children:"\uD83D\uDCAC"})})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[636,593,792],()=>r(4563)),_N_E=e.O()}]);