(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[309],{4563:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return s(7596)}])},7596:(e,t,s)=>{"use strict";s.r(t),s.d(t,{__N_SSP:()=>i,default:()=>c});var r=s(7876),a=s(1898),d=s(4232),o=s(4234),l=s(2009),n=s(9099),i=!0;function c(){let{currentUser:e,logout:t}=(0,a.As)(),s=(0,n.useRouter)(),[i,c]=(0,d.useState)([]),[h,m]=(0,d.useState)(!0);(0,d.useEffect)(()=>{(async()=>{m(!0);let e=(await (0,l.GG)((0,l.rJ)(o.db,"roleRequests"))).docs.map(e=>({id:e.id,...e.data()}));c(e),m(!1),console.log("[AdminDashboard] Fetched role requests:",e)})()},[]);let x=async e=>{try{await (0,l.mZ)((0,l.H9)(o.db,"users",e.userId),{role:"renter"}),await (0,l.mZ)((0,l.H9)(o.db,"roleRequests",e.id),{status:"approved"}),c(t=>t.map(t=>t.id===e.id?{...t,status:"approved"}:t)),console.log("[AdminDashboard] Approved request:",e)}catch(e){alert("Failed to approve request"),console.error("[AdminDashboard] Error approving request:",e)}},u=async e=>{try{await (0,l.mZ)((0,l.H9)(o.db,"roleRequests",e.id),{status:"rejected"}),c(t=>t.map(t=>t.id===e.id?{...t,status:"rejected"}:t)),console.log("[AdminDashboard] Rejected request:",e)}catch(e){alert("Failed to reject request"),console.error("[AdminDashboard] Error rejecting request:",e)}};return console.log("[AdminDashboard] currentUser:",e),(0,r.jsxs)("div",{className:"min-h-screen bg-gray-100 p-2 md:p-6 flex flex-col items-center",children:[(0,r.jsxs)("div",{className:"w-full max-w-2xl md:max-w-3xl bg-white rounded-2xl shadow-xl p-4 md:p-8 mt-4",children:[(0,r.jsx)("h1",{className:"mb-2 text-xl md:text-2xl font-bold text-gray-900",children:"Welcome to the Admin Dashboard!"}),(0,r.jsxs)("p",{className:"mb-6 text-gray-700",children:["Your role: ",(0,r.jsx)("span",{className:"font-semibold",children:"admin"})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("button",{className:"px-4 py-2 text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg font-medium w-full md:w-auto",onClick:()=>s.push("/admin/posts"),children:"\uD83D\uDCDD Manage Posts"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"mb-4 text-lg font-semibold text-gray-900",children:"Role Switch Requests"}),(0,r.jsx)("div",{className:"overflow-x-auto rounded-lg border border-gray-200 bg-gray-50",children:h?(0,r.jsx)("p",{className:"p-4 text-center text-gray-500",children:"Loading requests..."}):0===i.length?(0,r.jsx)("p",{className:"p-4 text-center text-gray-500",children:"No role switch requests found."}):(0,r.jsxs)("table",{className:"min-w-full text-sm text-left",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-100",children:[(0,r.jsx)("th",{className:"px-4 py-2 font-semibold text-gray-700",children:"Email"}),(0,r.jsx)("th",{className:"px-4 py-2 font-semibold text-gray-700",children:"Status"}),(0,r.jsx)("th",{className:"px-4 py-2 font-semibold text-gray-700",children:"Actions"})]})}),(0,r.jsx)("tbody",{children:i.map((e,t)=>(0,r.jsxs)("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:[(0,r.jsx)("td",{className:"px-4 py-2 break-all text-black",children:e.email}),(0,r.jsx)("td",{className:"px-4 py-2 font-semibold ".concat("approved"===e.status?"text-green-600":"rejected"===e.status?"text-red-600":"text-orange-500"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),(0,r.jsx)("td",{className:"px-4 py-2 space-x-2",children:"pending"===e.status&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>x(e),className:"px-3 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md mb-1 md:mb-0",children:"Approve"}),(0,r.jsx)("button",{onClick:()=>u(e),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded-md",children:"Reject"})]})})]},e.id))})]})})]})]}),(0,r.jsx)("div",{style:{position:"fixed",bottom:32,right:32,zIndex:1e3},children:(0,r.jsx)("button",{style:{background:"#4f46e5",color:"#fff",border:"none",borderRadius:"50%",width:60,height:60,fontSize:28,boxShadow:"0 4px 16px rgba(79,70,229,0.15)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700},onClick:()=>{console.log("[AdminDashboard] Floating chat button clicked"),s.push("/admin/chats").catch(e=>{console.error("Router push error:",e),window.location.href="/admin/chats"})},title:"Admin Chats",children:"\uD83D\uDCAC"})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(4563)),_N_E=e.O()}]);