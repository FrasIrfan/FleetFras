(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[341],{3790:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/purchaser/posts",function(){return r(9325)}])},9325:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var i=r(7876),o=r(1898),n=r(9099),d=r(4232),s=r(4234),a=r(2009);function l(){let{currentUser:e,logout:t}=(0,o.As)(),r=(0,n.useRouter)(),[l,c]=(0,d.useState)([]),[p,u]=(0,d.useState)(!0),[h,f]=(0,d.useState)({}),[m,b]=(0,d.useState)(1),[g,x]=(0,d.useState)(""),[y,w]=(0,d.useState)("");(0,d.useEffect)(()=>{(async()=>{u(!0);let t=(0,a.P)((0,a.rJ)(s.db,"posts"),(0,a._M)("status","==","approved")),r=(await (0,a.GG)(t)).docs.map(e=>({id:e.id,...e.data()}));e&&(r=r.filter(t=>t.ownerId!==e.uid)),c(r),[...new Set(r.map(e=>e.ownerId))];let i=await (0,a.GG)((0,a.rJ)(s.db,"users")),o={};i.forEach(e=>{let t=e.data();o[e.id]={name:t.displayName||"No Name",email:t.email||""}}),f(o),u(!1)})()},[e]);let j=async t=>{let i;if(!e)return;let o=(0,a.P)((0,a.rJ)(s.db,"chats"),(0,a._M)("userId","==",e.uid),(0,a._M)("renterId","==",t.ownerId),(0,a._M)("postId","==",t.id)),n=await (0,a.GG)(o);i=n.empty?(await (0,a.gS)((0,a.rJ)(s.db,"chats"),{userId:e.uid,renterId:t.ownerId,postId:t.id,messages:[],createdAt:new Date().toISOString()})).id:n.docs[0].id,r.push("/purchaser/chats/".concat(i))},v=l.filter(e=>{let t=Number(e.price),r=""!==g?Number(g):-1/0,i=""!==y?Number(y):1/0;return t>=r&&t<=i}),S=4*m,_=v.slice(S-4,S),I=Math.ceil(v.length/4);return(0,i.jsx)("div",{style:{padding:"2rem",minHeight:"100vh",background:"#f3f4f6"},children:(0,i.jsxs)("div",{style:{maxWidth:900,margin:"2rem auto"},children:[(0,i.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"1rem",marginBottom:"1.5rem"}}),(0,i.jsxs)("div",{style:{marginBottom:24,display:"flex",gap:16,alignItems:"center"},children:[(0,i.jsx)("label",{style:{fontWeight:500,color:"#222"},children:"Price Range:"}),(0,i.jsx)("input",{type:"number",placeholder:"Min",value:g,onChange:e=>x(e.target.value),style:{width:100,padding:"0.5rem",borderRadius:6,border:"1px solid #bbb",fontSize:"1rem",color:"#222"}}),(0,i.jsx)("span",{style:{color:"#888"},children:"-"}),(0,i.jsx)("input",{type:"number",placeholder:"Max",value:y,onChange:e=>w(e.target.value),style:{width:100,padding:"0.5rem",borderRadius:6,border:"1px solid #bbb",fontSize:"1rem",color:"#222"}})]}),(0,i.jsxs)("div",{style:{background:"#fff",borderRadius:12,boxShadow:"0 2px 12px rgba(0,0,0,0.10)",padding:"2rem",color:"#222"},children:[(0,i.jsx)("h1",{style:{marginBottom:"1.5rem",color:"#222"},children:"Available Posts"}),p?(0,i.jsx)("p",{children:"Loading posts..."}):0===l.length?(0,i.jsx)("p",{children:"No approved posts found."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"1.5rem",marginTop:"1rem"},children:_.map(e=>{var t,r;return(0,i.jsxs)("div",{style:{flex:"1 1 280px",minWidth:280,maxWidth:340,background:"#f9fafb",borderRadius:10,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",padding:"1.5rem",border:"1px solid #e5e7eb",display:"flex",flexDirection:"column",justifyContent:"space-between",position:"relative"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{fontWeight:700,color:"#4f46e5",fontSize:"1.1rem",marginBottom:6},children:["$",e.price]}),(0,i.jsx)("h2",{style:{fontSize:"1.2rem",fontWeight:600,color:"#222",marginBottom:8},children:e.title}),(0,i.jsx)("p",{style:{color:"#444",marginBottom:12},children:e.description}),(0,i.jsxs)("div",{style:{color:"#4f46e5",fontSize:13,marginBottom:6},children:["Owner: ",(null==(t=h[e.ownerId])?void 0:t.name)||"Unknown"," (",(0,i.jsx)("span",{style:{color:"#6366f1"},children:(null==(r=h[e.ownerId])?void 0:r.email)||""}),")"]})]}),(0,i.jsx)("button",{style:{position:"absolute",top:16,right:16,background:"#4f46e5",color:"#fff",border:"none",borderRadius:"50%",width:36,height:36,fontSize:18,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 2px 8px rgba(79,70,229,0.10)"},title:"Chat with Renter",onClick:()=>j(e),children:"\uD83D\uDCAC"})]},e.id)})}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginTop:24,gap:12},children:[(0,i.jsx)("button",{onClick:()=>b(e=>Math.max(1,e-1)),disabled:1===m,style:{padding:"0.5rem 1.2rem",background:1===m?"#e5e7eb":"#4f46e5",color:1===m?"#888":"#fff",border:"none",borderRadius:6,fontWeight:500,cursor:1===m?"not-allowed":"pointer"},children:"Previous"}),(0,i.jsxs)("span",{style:{alignSelf:"center",fontWeight:500,color:"#222"},children:["Page ",m," of ",I]}),(0,i.jsx)("button",{onClick:()=>b(e=>Math.min(I,e+1)),disabled:m===I,style:{padding:"0.5rem 1.2rem",background:m===I?"#e5e7eb":"#4f46e5",color:m===I?"#888":"#fff",border:"none",borderRadius:6,fontWeight:500,cursor:m===I?"not-allowed":"pointer"},children:"Next"})]})]})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(3790)),_N_E=e.O()}]);