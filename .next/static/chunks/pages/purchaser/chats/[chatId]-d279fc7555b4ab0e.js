(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[739],{2051:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var i=r(7876),d=r(1898),n=r(9099),l=r(4232),s=r(4234),o=r(2009);function a(){let{currentUser:e}=(0,d.As)(),{chatId:t}=(0,n.useRouter)().query,[r,a]=(0,l.useState)([]),[u,f]=(0,l.useState)(""),[c,h]=(0,l.useState)(null),[g,x]=(0,l.useState)(null),p=(0,l.useRef)(null);(0,l.useEffect)(()=>{if(!t)return;let e=(0,o.aQ)((0,o.H9)(s.db,"chats",t),async e=>{let t=e.data();if(h(t),a((null==t?void 0:t.messages)||[]),(null==t?void 0:t.postId)&&!g){let e=await (0,o.x7)((0,o.H9)(s.db,"posts",t.postId));x(e.exists()?{id:e.id,...e.data()}:null)}});return()=>e()},[t]),(0,l.useEffect)(()=>{var e;null==(e=p.current)||e.scrollIntoView({behavior:"smooth"})},[r]);let m=async()=>{if(!u.trim()||!t||!e)return;let i={sender:e.uid,text:u,timestamp:Date.now()},d=(0,o.H9)(s.db,"chats",t);await (0,o.mZ)(d,{messages:[...r,i]}),f("")};return(0,i.jsx)("div",{style:{padding:"2rem",minHeight:"100vh",background:"#f3f4f6",display:"flex",flexDirection:"column",alignItems:"center"},children:(0,i.jsxs)("div",{style:{width:"100%",maxWidth:500,background:"#fff",borderRadius:12,boxShadow:"0 2px 12px rgba(0,0,0,0.10)",padding:"2rem",color:"#222",display:"flex",flexDirection:"column",height:600},children:[(0,i.jsx)("h2",{style:{marginBottom:16,color:"#4f46e5"},children:"Chat with Renter"}),g&&(0,i.jsxs)("div",{style:{marginBottom:16,background:"#f9fafb",borderRadius:8,padding:12,border:"1px solid #eee"},children:[(0,i.jsxs)("div",{style:{fontWeight:700,color:"#4f46e5",fontSize:"1.1rem"},children:["$",g.price]}),(0,i.jsx)("div",{style:{fontWeight:600},children:g.title}),(0,i.jsx)("div",{style:{color:"#444",fontSize:14},children:g.description})]}),(0,i.jsxs)("div",{style:{flex:1,overflowY:"auto",marginBottom:16,background:"#f9fafb",borderRadius:8,padding:12,border:"1px solid #eee"},children:[0===r.length?(0,i.jsx)("p",{style:{color:"#888"},children:"No messages yet."}):r.map((t,r)=>(0,i.jsxs)("div",{style:{marginBottom:10,textAlign:t.sender===(null==e?void 0:e.uid)?"right":"left"},children:[(0,i.jsx)("div",{style:{fontSize:12,color:"#888",marginBottom:2,textAlign:t.sender===(null==e?void 0:e.uid)?"right":"left"},children:t.sender===(null==e?void 0:e.uid)?"You:":"Renter:"}),(0,i.jsx)("span",{style:{display:"inline-block",background:t.sender===(null==e?void 0:e.uid)?"#4f46e5":"#e0e7ff",color:t.sender===(null==e?void 0:e.uid)?"#fff":"#222",borderRadius:16,padding:"0.5rem 1rem",fontWeight:500,maxWidth:"70%",wordBreak:"break-word"},children:t.text})]},r)),(0,i.jsx)("div",{ref:p})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,i.jsx)("input",{type:"text",value:u,onChange:e=>f(e.target.value),placeholder:"Type your message...",style:{flex:1,padding:"0.75rem",borderRadius:8,border:"1px solid #bbb",fontSize:"1rem"},onKeyDown:e=>{"Enter"===e.key&&m()}}),(0,i.jsx)("button",{onClick:m,style:{padding:"0.75rem 1.5rem",background:"#4f46e5",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:"pointer"},children:"Send"})]})]})})}},6984:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/purchaser/chats/[chatId]",function(){return r(2051)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(6984)),_N_E=e.O()}]);